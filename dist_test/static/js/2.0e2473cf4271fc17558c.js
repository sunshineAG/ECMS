webpackJsonp([2],{1629:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(32);t.default={name:"",data:function(){return{form:this.$form.createForm(this),id:this.$route.query.id,title:"修改用户",loading:!1,userInfo:{avatar:""},departmentList:[],roleList:[],role:{},savFlg:!0,headers:{Authorization:s.store.get("token")},mediapath:""}},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},methods:{back:function(){this.$router.push({path:"/groupManage/userManage"})},handlePreview:function(e){},deleteFn:function(){},handleChange:function(e){if(this.loading=!0,"uploading"===e.file.status)return void(this.loading=!0);"done"===e.file.status?1==e.file.response.status?(this.userInfo.avatar=e.file.response.data.path,this.loading=!1):this.$notification.warning({message:"上传错误",description:e.file.response.msg}):"error"===e.file.status&&this.$notification.warning({message:"上传失败",description:"文件"+e.file.name+"上传失败"})},beforeUpload:function(e){var t="image/jpeg"===e.type||("image/png"===e.type||"image/jpg"===e.type);t||this.$notification.warning({message:"文件格式不正确",description:"文件格式不正确，请选择JPG或PNG。"});var a=e.size/1024/1024<1;return a||(this.$notification.warning({message:"超出文件大小限制",description:"图像不能大于1MB！"}),this.$message.error("图像不能大于1MB！")),t&&a},getDepartment:function(){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/organization/permission-dist-department",data:{department_id:this.$store.state.user.user.department.id,type:"2"}}).then(function(t){var a=t.data;1==a.status&&(e.departmentList=a.data.departmentList)})},getRole:function(){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/organization/role-list",data:{id:this.userInfo.id}}).then(function(t){var a=t.data;if(1==a.status&&(e.roleList=a.data.role_list,e.id&&!Array.isArray(a.data.role))){e.role=a.data.role;var s=!1;e.roleList.forEach(function(t){t.id==e.role.id&&(s=!0)}),s||e.roleList.push(e.role)}})},handleSubmit:function(){var e=this,t="",a="";return(this.userInfo.pass_word||this.id)&&/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[189])\d{8}$/.test(this.userInfo.tel)?this.userInfo.pass_word&&!/^[A-Za-z0-9]{6,16}$/.test(this.userInfo.pass_word)?(this.$message.warning("请输入6位以上的大小写字母及数字组成的密码"),!1):(this.id?(t="/index.php?r=uc/organization/user-update",a="修改用户成功"):(t="/index.php?r=uc/organization/user-add",a="新建用户成功"),void this.$axios({method:"POST",url:t,data:this.userInfo}).then(function(t){1==t.data.status&&(e.$message.success(a),e.back(),e.$axios({method:"GET",url:"/index.php?r=uc/user/list"}).then(function(t){var a=t.data;1==a.status&&(e.$store.commit("user/setUser",a.data.user),e.$store.commit("user/setDepartment",a.data.department),e.$store.commit("user/setManager",a.data.manager))}))})):(this.savFlg=!1,!1)},changeDepartment:function(e){this.userInfo.department_id=e}},created:function(){this.id?(this.title="修改用户",this.userInfo=s.store.get("editUser")):this.title="添加用户",this.getDepartment(),this.getRole()},destroyed:function(){s.store.remove("editUser")}}},1714:function(e,t,a){t=e.exports=a(15)(!1),t.push([e.i,"\n.user-manage[data-v-3fadc0a2] {\n  background: #ffffff;\n  height: calc(100vh - 90px);\n  overflow-y: auto;\n}\n.user-manage .header[data-v-3fadc0a2] {\n  padding: 0 20px;\n  height: 60px;\n  line-height: 60px;\n  border-bottom: 2px solid #f0f2f5;\n}\n.user-manage .content[data-v-3fadc0a2] {\n  padding: 20px;\n}\n.avatar-uploader[data-v-3fadc0a2],\n.avatar-uploader-trigger[data-v-3fadc0a2],\n.avatar[data-v-3fadc0a2] {\n  width: 150px;\n  height: 150px;\n}\n.avatar-uploader[data-v-3fadc0a2] {\n  display: block;\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n}\n.avatar-uploader-trigger[data-v-3fadc0a2] {\n  display: table-cell;\n  vertical-align: middle;\n  font-size: 30px;\n  color: #6f96ff;\n  height: 150px;\n  line-height: 150px;\n}\n",""])},2106:function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-manage"},[a("div",{staticClass:"header"},[e._v("\n        "+e._s(e.title)+"\n    ")]),e._v(" "),a("div",{staticClass:"content"},[a("a-form",{attrs:{form:e.form},on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"上传头像"}},[a("a-upload",{staticClass:"avatar",attrs:{name:"file",headers:e.headers,listType:"picture-card",beforeUpload:e.beforeUpload,showUploadList:!1,action:"/index.php?r=uc/user/upload"},on:{change:e.handleChange}},[a("div",{attrs:{className:"ant-upload-text"}},[a("div",{staticClass:"avatar",style:{background:"url("+e.userInfo.avatar+") no-repeat center/90%",backgroundSize:"contain",width:"150px"}},[e.userInfo.avatar?e._e():a("a-icon",{staticClass:"avatar-uploader-trigger",attrs:{type:"plus",size:"30"}})],1)])])],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"登录账号",validateStatus:e.savFlg?"":/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[189])\d{8}$/.test(e.userInfo.tel)?"success":"error",help:e.savFlg?"":/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[189])\d{8}$/.test(e.userInfo.tel)?"":"请输入正确的手机账号"}},[a("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入登录账号",maxlength:"11"},model:{value:e.userInfo.tel,callback:function(t){e.$set(e.userInfo,"tel",t)},expression:"userInfo.tel"}})],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"密码",validateStatus:e.savFlg?"":e.userInfo.pass_word?"success":"error",help:e.savFlg?"":e.userInfo.pass_word?"":"请输入密码"}},[a("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入密码",maxlength:"16"},model:{value:e.userInfo.pass_word,callback:function(t){e.$set(e.userInfo,"pass_word",t)},expression:"userInfo.pass_word"}})],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"用户名"}},[a("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入用户名",maxlength:"10"},model:{value:e.userInfo.user_name,callback:function(t){e.$set(e.userInfo,"user_name",t)},expression:"userInfo.user_name"}})],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"所属部门"}},[a("a-select",{staticStyle:{width:"80%"},attrs:{placeholder:"下拉选择所属部门"},on:{change:e.changeDepartment},model:{value:e.userInfo.department_id,callback:function(t){e.$set(e.userInfo,"department_id",t)},expression:"userInfo.department_id"}},e._l(e.departmentList,function(t,s){return a("a-select-option",{key:t.id},[e._v("\n                        "+e._s(t.name)+"\n                    ")])}),1)],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:"角色"}},[a("a-select",{staticStyle:{width:"80%"},attrs:{placeholder:"下拉选择角色"},model:{value:e.userInfo.role_id,callback:function(t){e.$set(e.userInfo,"role_id",t)},expression:"userInfo.role_id"}},e._l(e.roleList,function(t,s){return a("a-select-option",{key:t.id},[e._v("\n                        "+e._s(t.name)+"\n                    ")])}),1)],1),e._v(" "),a("a-form-item",{attrs:{labelCol:{span:5},wrapperCol:{span:18},label:" ",colon:!1}},[a("div",{staticStyle:{width:"80%","text-align":"right"}},[a("a-button",{staticStyle:{"margin-right":"10px"},on:{click:e.back}},[e._v("返回")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",htmlType:"submit"}},[e._v("保存")])],1)])],1)],1)])},staticRenderFns:[]},e.exports.render._withStripped=!0},2195:function(e,t,a){var s=a(1714);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a(16)("b5b25bd8",s,!1)},545:function(e,t,a){a(2195);var s=a(20)(a(1629),a(2106),"data-v-3fadc0a2",null);s.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\view\\groupManage\\editUser.vue",s.esModule&&Object.keys(s.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] editUser.vue: functional components are not supported with templates, they should use render functions."),e.exports=s.exports}});