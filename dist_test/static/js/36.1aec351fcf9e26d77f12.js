webpackJsonp([36],{1222:function(t,e,n){n(2189);var a=n(20)(n(1626),n(2102),"data-v-35ca2904",null);a.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\view\\groupManage\\departmentManage.vue",a.esModule&&Object.keys(a.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] departmentManage.vue: functional components are not supported with templates, they should use render functions."),t.exports=a.exports},1252:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAxKSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgIDxlbGxpcHNlIGZpbGw9IiNGNUY1RjUiIGN4PSIzMiIgY3k9IjMzIiByeD0iMzIiIHJ5PSI3Ii8+CiAgICA8ZyBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZT0iI0Q5RDlEOSI+CiAgICAgIDxwYXRoIGQ9Ik01NSAxMi43Nkw0NC44NTQgMS4yNThDNDQuMzY3LjQ3NCA0My42NTYgMCA0Mi45MDcgMEgyMS4wOTNjLS43NDkgMC0xLjQ2LjQ3NC0xLjk0NyAxLjI1N0w5IDEyLjc2MVYyMmg0NnYtOS4yNHoiLz4KICAgICAgPHBhdGggZD0iTTQxLjYxMyAxNS45MzFjMC0xLjYwNS45OTQtMi45MyAyLjIyNy0yLjkzMUg1NXYxOC4xMzdDNTUgMzMuMjYgNTMuNjggMzUgNTIuMDUgMzVoLTQwLjFDMTAuMzIgMzUgOSAzMy4yNTkgOSAzMS4xMzdWMTNoMTEuMTZjMS4yMzMgMCAyLjIyNyAxLjMyMyAyLjIyNyAyLjkyOHYuMDIyYzAgMS42MDUgMS4wMDUgMi45MDEgMi4yMzcgMi45MDFoMTQuNzUyYzEuMjMyIDAgMi4yMzctMS4zMDggMi4yMzctMi45MTN2LS4wMDd6IiBmaWxsPSIjRkFGQUZBIi8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"},1253:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"dataStatus",props:["width","height","material"],components:{},data:function(){return{}}}},1254:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,"\n.imgBg[data-v-6c09838e]{\n    opacity:1;\n    text-align:center;\n    position:relative;\n}\n.text[data-v-6c09838e]{\n    position:absolute;\n    left:50%;\n    bottom:44px;\n    color:#ccc;\n    transform: translateX(-50%);\n}\n.matText[data-v-6c09838e]{\n    position:absolute;\n    left:50%;\n    bottom:86px;\n    color:#00000073;\n    transform: translateX(-50%);\n}\n",""])},1255:function(t,e,n){n(1257);var a=n(20)(n(1253),n(1256),"data-v-6c09838e",null);a.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\components\\pageConfig\\dataStatus.vue",a.esModule&&Object.keys(a.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] dataStatus.vue: functional components are not supported with templates, they should use render functions."),t.exports=a.exports},1256:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"imgBg"},[a("svg",{staticStyle:{"text-align":"center"},attrs:{width:t.width,height:t.height}},[a("image",{attrs:{"xlink:href":n(1252),width:"100%"}})]),t._v(" "),t.material?t._e():a("span",{staticClass:"text"},[t._v("暂无数据")]),t._v(" "),t.material?a("span",{staticClass:"matText"},[t._v("暂不支持")]):t._e()])},staticRenderFns:[]},t.exports.render._withStripped=!0},1257:function(t,e,n){var a=n(1254);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(16)("4232382d",a,!1)},1626:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(1255),i=n.n(a),s=(n(94),n(32));e.default={name:"",components:{dataStatus:i.a},data:function(){return{searchKey:"",page:1,page_size:10,selectId:"",total:0,departmentList:[],locale:{filterConfirm:"",filterReset:"",emptyText:""},columns:[{title:"部门名称",align:"center",dataIndex:"name"},{title:"设备编号",align:"center",dataIndex:"assistant",scopedSlots:{customRender:"assistant"}},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],selectedRowKeys:[],robotModal:!1,selectDepartment:{},departmentTree:[],expandedKeys:[]}},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},methods:{searchList:function(){this.page=1,this.page_size=10,this.getDepartment(this.selectId)},emitEmpty:function(){this.page=1,this.page_size=10,this.searchKey="",this.getDepartment(this.selectId)},onChange:function(t,e){this.page=t,this.page_size=e,this.getDepartment(this.selectId)},onShowSizeChange:function(t,e){this.page=1,this.page_size=e,this.getDepartment(this.selectId)},getDepartmentTree:function(t){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/organization/permission-dist-department",data:{department_id:this.$store.state.user.user.department.id}}).then(function(n){var a=n.data;1==a.status&&(e.departmentTree=e.listToTree(a.data.departmentList),t&&(e.selectId=e.departmentTree[0].key,e.getDepartment(e.departmentTree[0].key)))})},onSelect:function(t,e){this.selectId=t[0],this.getDepartment(t[0])},listToTree:function(t){var e=this,n=[];return t.forEach(function(t){t.children&&t.children.length>0&&(t.children=e.listToTree(t.children),e.expandedKeys.push(t.id)),n.push({title:t.name,key:t.id,children:t.children})}),n},getDepartment:function(t){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/organization/department",data:{department_id:t,searchKey:this.searchKey,p:this.page,n:this.page_size}}).then(function(n){var a=n.data;1==a.status&&(e.departmentList=a.data.departmentList,e.total=parseInt(a.data.departmentCount),0==a.data.departmentList.length&&e.page>1&&(e.page-=1,e.getDepartment(t)))})},setRobot:function(t){console.log(t),s.store.set("editDepartment",t),this.$router.push({path:"/groupManage/setRobot",query:{type:"1"}})},addDepartment:function(){s.store.remove("editDepartment"),this.$router.push({path:"/groupManage/addDepartment"})},edit:function(t){s.store.set("editDepartment",t),this.$router.push({path:"/groupManage/editDepartment",query:{id:t.id}})},del:function(t){var e=this;this.$confirm({title:"确定删除当前部门？",content:"部门删除之后，角色会和被删除部门解绑,是否确定",onOk:function(){e.$axios({method:"POST",url:"/index.php?r=uc/organization/department-del",data:{id_arr:[t]}}).then(function(t){1==t.data.status&&(e.$message.success("删除成功"),e.getDepartment(e.selectId))})}})},onSelectChange:function(t){this.selectedRowKeys=t},delSelect:function(){var t=this;if(0==this.selectedRowKeys.length)return void this.$message.warning("请选择需要删除的部门");this.$axios({method:"POST",url:"/index.php?r=uc/organization/department-del",data:{id_arr:this.selectedRowKeys}}).then(function(e){1==e.data.status&&(t.$message.success("删除成功"),t.getDepartment())})},showRobotModal:function(t){this.selectDepartment=t,this.robotModal=!0},onExpand:function(t){this.expandedKeys=t}},created:function(){this.getDepartmentTree(!0)}}},1708:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,"\n.department-manage[data-v-35ca2904] {\n  background: #ffffff;\n  height: calc(100vh - 90px);\n  overflow-y: auto;\n}\n.department-manage .header[data-v-35ca2904] {\n  padding: 0 20px;\n  height: 60px;\n  line-height: 60px;\n}\n.department-manage .header .add-user[data-v-35ca2904] {\n  margin-top: 14px;\n  float: right;\n}\n.department-manage .content[data-v-35ca2904] {\n  padding: 20px;\n  position: relative;\n}\n@media screen and (max-width: 1300px) {\n.department-manage .content[data-v-35ca2904] {\n    padding: 20px;\n    position: relative;\n    width: 900px;\n}\n}\n.ant-table-thead > tr > th[data-v-35ca2904],\n.ant-table-tbody > tr > td[data-v-35ca2904] {\n  padding: 6px;\n}\n.left-content[data-v-35ca2904] {\n  padding: 20px;\n  overflow-y: auto;\n  height: calc(100vh - 175px);\n  border-right: 2px solid #eee;\n}\n.left-header[data-v-35ca2904] {\n  padding: 0 20px;\n  height: 60px;\n  line-height: 60px;\n  border-right: 2px solid #eee;\n  border-bottom: 2px solid #f0f2f5;\n}\n.stausPage[data-v-35ca2904] {\n  position: absolute;\n  left: 50%;\n  top: 200px;\n  z-index: 999;\n  transform: translate(-50%, 0);\n}\n",""])},2102:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"department-manage"},[n("a-row",[n("a-col",{attrs:{xl:4,sm:6}},[n("div",{staticClass:"left-header"},[t._v("\n                部门结构\n            ")]),t._v(" "),n("div",{staticClass:"left-content"},[n("a-tree",{attrs:{treeData:t.departmentTree,defaultExpandAll:!0,expandedKeys:t.expandedKeys},on:{select:t.onSelect,expand:t.onExpand}})],1)]),t._v(" "),n("a-col",{attrs:{xl:20,sm:18}},[n("div",{staticClass:"header"},[n("a-input-search",{staticStyle:{width:"300px","margin-top":"14px"},attrs:{placeholder:"请输入负责人、部门、机器人名称搜索",enterButton:""},on:{search:t.searchList},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),t._v(" "),n("a-button",{staticClass:"add-user",attrs:{type:"primary"},on:{click:t.addDepartment}},[t._v("新建")])],1),t._v(" "),n("div",{staticClass:"content"},[n("a-table",{staticStyle:{"min-height":"700px"},attrs:{columns:t.columns,dataSource:t.departmentList,locale:t.locale,pagination:!1,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"assistant",fn:function(e,a,i){return[n("div",{staticStyle:{position:"relative","max-width":"400px"}},[t._l(e,function(e,a){return n("div",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap",display:"inline-block","vertical-align":"bottom"}},[a>5?t._e():n("span",[t._v("\n                            ["+t._s(e.mobile_serial_name)+"]"+t._s(e.nickname)+"\n                       ")])])}),t._v(" "),e.length>0?n("a",{staticStyle:{position:"absolute",right:"-30px",top:"50%",transform:"translateY(-50%)"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.showRobotModal(a)}}},[t._v("详细")]):t._e()],2)]}},{key:"action",fn:function(e,a,i){return[n("div",{},[n("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.edit(a)}}},[t._v("编辑")]),t._v(" "),n("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.del(a.id)}}},[t._v("删除")])])]}}])}),t._v(" "),n("br"),t._v(" "),t.departmentList.length?n("a-pagination",{staticStyle:{"text-align":"right"},attrs:{showQuickJumper:"",showSizeChanger:"",showTotal:function(t){return"总共"+t+"条"},pageSize:t.page_size,total:t.total,pageSizeOptions:["10","20","30","40","50"]},on:{change:t.onChange,showSizeChange:t.onShowSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}):t._e(),t._v(" "),n("br")],1)])],1),t._v(" "),n("a-modal",{attrs:{title:"设备编号",footer:null,visible:t.robotModal,bodyStyle:{maxHeight:"500px",overflowY:"auto"}},on:{cancel:function(e){t.robotModal=!1}}},[n("div",{},[n("a-form",[n("a-form-item",{attrs:{colon:!0,labelCol:{span:4},wrapperCol:{span:20},label:"部门名称:"}},[n("span",[t._v(t._s(t.selectDepartment.name))])]),t._v(" "),n("a-form-item",{attrs:{colon:!0,labelCol:{span:4},wrapperCol:{span:20},label:"设备编号:"}},t._l(t.selectDepartment.assistant,function(e){return n("span",{staticStyle:{"margin-right":"5px"}},[t._v("\n                        ["+t._s(e.mobile_serial_name)+"]"+t._s(e.nickname)+"\n                    ")])}),0)],1)],1)])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},2189:function(t,e,n){var a=n(1708);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(16)("fc7861ca",a,!1)}});