webpackJsonp([17],{1210:function(t,e,n){n(2171),n(2170);var i=n(20)(n(1614),n(2090),"data-v-184b865a",null);i.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\view\\customerManage\\groupList.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] groupList.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},1252:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAxKSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgIDxlbGxpcHNlIGZpbGw9IiNGNUY1RjUiIGN4PSIzMiIgY3k9IjMzIiByeD0iMzIiIHJ5PSI3Ii8+CiAgICA8ZyBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZT0iI0Q5RDlEOSI+CiAgICAgIDxwYXRoIGQ9Ik01NSAxMi43Nkw0NC44NTQgMS4yNThDNDQuMzY3LjQ3NCA0My42NTYgMCA0Mi45MDcgMEgyMS4wOTNjLS43NDkgMC0xLjQ2LjQ3NC0xLjk0NyAxLjI1N0w5IDEyLjc2MVYyMmg0NnYtOS4yNHoiLz4KICAgICAgPHBhdGggZD0iTTQxLjYxMyAxNS45MzFjMC0xLjYwNS45OTQtMi45MyAyLjIyNy0yLjkzMUg1NXYxOC4xMzdDNTUgMzMuMjYgNTMuNjggMzUgNTIuMDUgMzVoLTQwLjFDMTAuMzIgMzUgOSAzMy4yNTkgOSAzMS4xMzdWMTNoMTEuMTZjMS4yMzMgMCAyLjIyNyAxLjMyMyAyLjIyNyAyLjkyOHYuMDIyYzAgMS42MDUgMS4wMDUgMi45MDEgMi4yMzcgMi45MDFoMTQuNzUyYzEuMjMyIDAgMi4yMzctMS4zMDggMi4yMzctMi45MTN2LS4wMDd6IiBmaWxsPSIjRkFGQUZBIi8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"},1253:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"dataStatus",props:["width","height","material"],components:{},data:function(){return{}}}},1254:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,"\n.imgBg[data-v-6c09838e]{\n    opacity:1;\n    text-align:center;\n    position:relative;\n}\n.text[data-v-6c09838e]{\n    position:absolute;\n    left:50%;\n    bottom:44px;\n    color:#ccc;\n    transform: translateX(-50%);\n}\n.matText[data-v-6c09838e]{\n    position:absolute;\n    left:50%;\n    bottom:86px;\n    color:#00000073;\n    transform: translateX(-50%);\n}\n",""])},1255:function(t,e,n){n(1257);var i=n(20)(n(1253),n(1256),"data-v-6c09838e",null);i.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\components\\pageConfig\\dataStatus.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] dataStatus.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},1256:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"imgBg"},[i("svg",{staticStyle:{"text-align":"center"},attrs:{width:t.width,height:t.height}},[i("image",{attrs:{"xlink:href":n(1252),width:"100%"}})]),t._v(" "),t.material?t._e():i("span",{staticClass:"text"},[t._v("暂无数据")]),t._v(" "),t.material?i("span",{staticClass:"matText"},[t._v("暂不支持")]):t._e()])},staticRenderFns:[]},t.exports.render._withStripped=!0},1257:function(t,e,n){var i=n(1254);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(16)("4232382d",i,!1)},1273:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(225);e.default={name:"divEdittArea",props:{formItem:{type:Object,default:{text:""}}},data:function(){return{innerText:"",lock:!1}},computed:{},watch:{formItem:{handler:function(t,e){this.lock||(this.innerText=this.formItem.text)},deep:!0,immediate:!0}},created:function(){},methods:{changeTxt:function(t){if(i.htmlToString(this.$el.innerHTML).length>500){if(this.$el.innerHTML=this.$el.innerHTML.substring(0,500),window.getSelection){var e=document.getElementsByClassName("div-edit")[0];e.focus();var n=window.getSelection();n.selectAllChildren(e),n.collapseToEnd()}else if(document.selection&&document.selection.createRange){var a=document.getElementsByClassName("div-edit")[0],o=document.selection.createRange();o.moveToElementText(a),o.collapse(!1),o.select()}}else this.$emit("change"),this.formItem.text=this.$el.innerHTML},clickEvent:function(t){this.$emit("change")},clearContent:function(){this.$el.innerHTML=""},enterkey:function(t){if(13==t.keyCode){if(t.returnValue=!1,t.keyCode?t.keyCode:t.which?t.which:t.charCode,document.selection&&document.selection.createRange)document.selection.createRange().pasteHTML("<br />");else if(window.getSelection){var e=window.getSelection(),n=window.getSelection().getRangeAt(0);n.deleteContents();var i=document.createElement("br");n.insertNode(i),n=n.cloneRange(),n.setStartAfter(i),n.collapse(!0),e.removeAllRanges(),e.addRange(n)}this.changeTxt()}},paste:function(t){t.preventDefault();var e=void 0,n=(t.originalEvent||t).clipboardData;if(void 0===n||null===n){if(""!==(e=window.clipboardData.getData("text")||""))if(window.getSelection){var i=document.createElement("span");i.innerHTML=e,window.getSelection().getRangeAt(0).insertNode(i)}else document.selection.createRange().pasteHTML(e)}else""!==(e=n.getData("text/plain")||"")&&(e=e.replace(/(\r\n)|(\n)/g,"<br>"),document.execCommand("insertHTML",!1,e))}}}},1274:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,'\n.div-edit[data-v-7878f639] {\n\t\t /*height: 100px;*/\n\t\tmin-height: 100px;\n\t\t/*border:1px solid #c2c2c2;*/\n\t\toverflow-y: auto;\n\t\tline-height: 1.4;\n\t\tpadding: 10px;\n\t\toutline: none;\n\t\tword-break: break-all;\n\t\tword-wrap: break-word;\n\t\twhite-space: pre-wrap;\n\t\tborder: 1px solid #6fabfa;\n\t\tborder-radius: 5px;\n        /*max-width: 870px;*/\n\t\tfont-family: "Chinese Quote", -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n}\n',""])},1275:function(t,e,n){n(1277);var i=n(20)(n(1273),n(1276),"data-v-7878f639",null);i.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\components\\dataManage\\divEditArea.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] divEditArea.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},1276:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("pre",{staticClass:"div-edit",attrs:{id:"divEdit",contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{input:t.changeTxt,focus:function(e){t.lock=!0},blur:function(e){t.lock=!1},keydown:function(e){return t.enterkey(e)},paste:function(e){return t.paste(e)},click:t.clickEvent}},[t._v("\n")])},staticRenderFns:[]},t.exports.render._withStripped=!0},1277:function(t,e,n){var i=n(1274);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(16)("21217889",i,!1)},1278:function(t,e,n){t.exports=n.p+"static/img/room_avatar.f4934ab.png"},1287:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAAB3RJTUUH4wkbEQoG2GT1mwAACj1JREFUeNrt232Q3WV1B/DPc+9uEgKE3bwA5SWILVRbAg7EYmXEqaCY0YIzUO1YbAtKbB2kpWARkk3HXUtB20AHGVvSpuHFMkxH0UKHUkmx0IIvoaQJVRINRgnBkJBdSUhI7t7f6R/PXfbu3bvZl2yyYbrfmTt77/2d+/ye3/c55zznOecsk5jEJCYxiUlMYhITgzTuI3Z2s6fM1KJVcoSIE9GO6ZiFw1BgJ17GHmzBZintFlG1pP0NTsifv0K5TGXvTGEefg2/jrm11xEoowWl2q+qqNTI6cZP8UN8G9+W0nrV4lWHtXLdkW8QQrq6kaaIOA0fwvvxFuzPE4SsOavxAP5FSj9GoaPtECWkqxtahXfi4zUi5hyA+RXYiK9iuZSeFeFAmtToCOnqplyit3gL/ggfxsxhfhXYK5vI7tr7hGmYKpvSlBHcfQNux114WUoOhMaMnJDOHpKpIj6CRTh1H9I9sj9Yjf/F92tk7Kj9Lcl+ZTpm4AzZ1M7Em2rfN0MvHsUSqfwdihhvUkZGSGc3zEaHbCKHN5Hag7X4Z3wT66RSDzH8pLt6oCxiTo2cBfgATpY1qBGb0CGle9A7nqQMT0j2F8cLt+Bi/btEHyp4AsvwsNSyjerY1bmrB6kkYi5xMS7HW5vM9RXcJKVbhd2WjA8p+yaks5vkOOHLuLCJxHO4FV/BduUyi2aMy8R09TB9Gq/uPhmfkjWz0Zvuwc24EXvGw9kOTUg2kyNlR/axhqsFHsYiG7c97eQ5B8TBZWK6kcoiPoS/wCkNErtwg1LpNhH7vTU3J6Tfpm+Q/UZr3dVeLMdibD0oUWVXd96rmI+/xjsbJLbjEyLuVyrt1+KUBn3z+R4iiLgAVzeQUcWXSdceNDKgo52UYBV+H481SMzE56R0ioj9utVgQoogOVbeWhuf+B7SEmLHQT9vdLT16fMP8Wl5R6vHPFwjpSk1DR8HQrp6smqGS+WzSD2eIC0meibs8NXRTqkEa/AZbGuQ+G0R794fLRlISATJifg9A/1LN7qITVJpFMMfACw+KptPqfRN/I0+75JxFD4hpalj1ZL+p+sf4P34lQa5+6T0SA6Xj5pYQsjmUxQF7jDYdM4TccZYtaSfkDzANFxkoOa8hOUixjUi3G8khOdxp4FaMkuOcvuCyjESknEKzmr4bqWUVte8/KGDjvY+o/6GHCDW4z04yhiUpJGQXzXwGB94RETlkNKOPiSU0kY82XDlFBw/liEbCZlv4GHqVayf6OceEh3tFFGVs2z1mC1vw2Mk5PM/Z2cPtDVcf5G08UCkXscZP8JrdZ/Lsi8ZIyERHNneiqMbrm8hRu+ZDj5+Iudg6jGmU2ZL3fuywXmOKgpj8U4HF7uxnVQhyjhOTkCNlZBAKuTj9BsQaXtL69ZPTZm2YUtlz8mpsueEC6TKDjF6U68RkiiVKqrVxlD4CDk22T3Rj9wM81ZCe2viN/CxYE5iE1OWb3jq0SfPvvgc//5noxsz+5CONqrVwM8brs/FCRP94M1wxkqKAuHSCHdHuER4d4Tfidh775vPOue9W3/M6SvHQkg/ftDwuU3Oax5yKIJScrR88m10oEcLV0oOH633ayTkf+TMeB9a8XYRfRm0Qw1zDB2AnSbMHe1+0EjIswYHYguUSnMOudA9Y7eB8Uc9ZsvJ6TESklAtXpZLCPU4XcSCQ01LUn5tknO7zdCK30xJy7xR+JF+Qjrac1WOrxuYeGnFJw0O2iYUa84nchWwE3fLgVmjgSyIcOZozGagyaRESv+NBxvk3oFPSqWks2dCiYiniFXEKmetafPFNW1mrK1aiAvwB1ghdxIEjsFnUjJjpLvNYMeQzeJsWVOOrbuyDZcLDygnFrdNCBlaUHEuviSXPT+Ch9J8Tn8ElINfkpPRl8sJ6M6U3ITKmvP2fY8m+cBEKn3X4PTcbHxBMl8RY0q+7A8R8TTC0SquxT/KR/wOyb/1Leua81lzvmpK1pWTRfioHEpcH+Gyohg+Lmm+dfTXcv/e4IrdWlylWnxLuXTAWhPiKTBFmIs3y0mf98nH+jJuwQ3Yk+YP/v28lfqWcx46mPofa5/Y9gy9F8ldTGtIXyVequ8kGK5ydxruMzjHuhGfldLXiIqO8SMlNsgp7WwOi2skzJFbJ/rmu1peqOebkVFPynnv4bHHta5+7KVLi6L1Zv0JsAIPYSE29y3s0IT0V8sulJO5xzRIvCIXspZLpXFLPscq5Oz5CrkrqRn+BLdIpLOGGbCzB+kkiofxy00kFgk3mpr4bJuhawp9q55KD+Aag2sgM3ChlFoPQHrg7bJmNMML+FdGQAby3Iqz8YtDCLxDKbWq5A/7LrIsaSciSPfij+Uaaj22mTqtMi4UPBr5lXGcbOfNsE6ycURjdvX0VRPmGZj7qUdF3Yq2DDvokjY6uwvcL9vbubUrBZ70Wi0zkH3OqbKJzZGPAU9hi2R7Ti8U/U64a4dssb2HiZjp8Z6T8La0Jx6OS9JPVO3SvDHne/babeoICIkglWYS7x1CohcrRfT2HU2GJ4S+QvNUEfUT7MbTNYFZxEdxpf5Wq0LuJtwmrFMtfobQ2d2LJHr72jTfJO8iszHDlFf+0C+42yYP4ZKGmayPHvf3LjW99V129V5By7Ih5tzZU1v4uABvayKxCytIXyFe32VGRkgucR4jq3IfnpXST0V8kLhWblGo7xQoyZoyx2gOWan4rXR7/FNcnK7W60W5vWoKnsFN1fssSMf7XO9z/lRYU11I+Y6mk1ab71W8rk8/kzP0z+BxKf2niF31ocNoeszeJTuzvoa4tbXXB40xoTsECtwjyovjshmbveQYtEi2937DTi+6El/EOlyTSr4lVFvqSensJqXDRfylHM5vxT24U/ID7B0qVBiZhmTMaJCfZ3DtY69sRoVsBrNGcY9dtYk/g2elakta0V3V0rLZDbkPuPcKJHdEOBbX494o/APu7F1oPXpbTughaa01+3wc38N1UnqMqA4XM41GQ67G0iEk9tZuvAwPSqlXxHFyYHcsTqq9Zunf2fp63J+TVXkD1ku2iHjNie1cNnh6lSuQ+1ZWyA48sFluonmihVULZ962adnhv3sXxV7Zr/1IqZQ7B4bBaAi5rTZ4IxHfxd/hAUVs11piUVu/xM07aWlh92stimh5/Z5JIZUqKtXCme1cNPIEVI2Uc/E1AwtSIf9Twdeva7/x9qUzrn9OsWOr9ul8eoT7xygIuUrWkHIdEctID1Jsp2S8WiNHQkhKpkS4Sz7tNnuwW8sV1ygp0vKRjz0aH3KXvIuciv+S0oNSbFdgyXDd3eOL1mVUrrBXdvIf1mRhgw9UWy3F86MZe2SE5G2pB391UJ98eKySHXGzbN4R0Tyw2ycmuD9qv/GCXOhuhu+nZNNoU+NvXELyzLtlv7a14eoLWBph52gbFw7J2sJI0bsQlCOcI/fhv1X+74v7SmXfiRAtf/v/iJAGYkqy068EResd+zXkJCYxiUlMYhKTOPD4P/IsTJe12shgAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA5LTI3VDE3OjEwOjA2KzA4OjAwpALNWwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wOS0yN1QxNzoxMDowNiswODowMNVfdecAAABOdEVYdHNvZnR3YXJlAEltYWdlTWFnaWNrIDYuOC45LTEwIFExNiB4ODZfNjQgMjAxNi0xMS0yNSBodHRwOi8vd3d3LmltYWdlbWFnaWNrLm9yZ2+o35IAAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAYdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADUxMo+NU4EAAAAXdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANTEyHHwD3AAAABl0RVh0VGh1bWI6Ok1pbWV0eXBlAGltYWdlL3BuZz+yVk4AAAAPdEVYdFRodW1iOjpTaXplADBCQpSiPuwAAAASdEVYdFRodW1iOjpVUkkAZmlsZTovL8F3i88AAAAASUVORK5CYII="},1614:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(54),a=n.n(i),o=n(137),s=n.n(o),r=n(3),c=n.n(r),l=n(1275),d=n.n(l),u=n(1255),h=n.n(u),m=(n(94),n(225)),p=n(93),f=n(32);e.default={name:"",components:{divEditArea:d.a,dataStatus:h.a},data:function(){return{form:this.$form.createForm(this),heightFlg:!1,sheight:"",com_visible:!1,collocation_visible:!1,locale:{filterConfirm:"",filterReset:"",emptyText:""},weChatList:["微信测试1","微信测试2"],queryParam:{department_id:"",user_id:"0",key:"",label:[],weChat:"",assistant_id:"0"},managerList:[],labelList:[],expand:!1,roomList:[],columns:[{title:"群头像",width:"10%",dataIndex:"avatar_url",align:"left",scopedSlots:{customRender:"avatar_url"}},{title:"群名称",width:"20%",align:"left",dataIndex:"room_name",scopedSlots:{customRender:"room_name"}},{title:"群主",align:"left",width:"15%",dataIndex:"nickname"},{title:"群码",align:"left",width:"15%",dataIndex:"qr_code",scopedSlots:{customRender:"qr_code"}},{title:"托管信息",width:"20%",align:"center",dataIndex:"trusteeship",scopedSlots:{customRender:"trusteeship"}},{title:"操作",dataIndex:"action",width:"20%",align:"center",scopedSlots:{customRender:"action"}}],page_size:10,page:1,total:0,selectedRowKeys:[],noticeObj:{text:"",room_id:[]},emojiList:m.emojiList,replyList:[],welcomeList:[],collocationStatus:"",selectRoomId:"",departmentList:[],disableDepartment:!0,clientHeight:""}},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route),this.globalClick(this.closeEmoji),window.addEventListener("resize",this.autoHeight,!1)},watch:{roomList:function(){var t=""+document.documentElement.clientHeight,e=this.$refs.header.offsetHeight+126;this.$nextTick(function(){t-e<=this.$refs.table.$el.offsetHeight+40?(this.heightFlg=!0,this.sheight=t-e-this.$refs.header.offsetHeight+45):this.heightFlg=!1})}},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},computed:{emojiFlag:function(){return this.$store.state.liveChat.emojiFlag}},methods:{moment:c.a,autoHeight:function(){var t=this,e=p.autoHeight(t.$refs.header,t.$refs.table);e&&(t.sheight=e.sheight?e.sheight-t.$refs.header.offsetHeight+15:"",t.heightFlg=e.heightFlg)},managerChange:function(t){this.queryParam.user_id=t,this.page=1,this.page_size=10,this.getWeChat(t)},choseWeChat:function(t){this.queryParam.assistant_id=this.weChatList[t].username,this.page=1,this.page_size=10,this.getRoomList()},qrExpireTime:function(t){return p.compareTime(t,p.formatDate(new Date))},getExpireQR:function(t){var e=this;p.isOfflineRobot(t.room_owner,this.$store.state.user.offlineRobot)&&this.$store.commit("user/setRobotStatus","2");var n={cmd:2020,fromClientId:this.$store.state.user.user.user_id,toClientId:t.room_owner,cmdData:{username:t.room_wx_id},priority:0};this.$ws.sendMsgFun(n),this.$ws.cmd2020=function(t){2==t.status&&"成功"==t.callbackMsg?e.getRoomList():4==t.status&&e.$notification.warning({message:function(e){return e("div",{domProps:{innerHTML:t.callbackMsg}})},description:"暂无法执行操作，请检查手机连接状态",duration:2,style:{background:"#fbf8e9"}})}},toggle:function(){this.expand=!this.expand},clear:function(){this.disableDepartment=!0,this.queryParam={department_id:this.$store.state.user.user.department.id||this.departmentList[0].key,user_id:"0",key:"",label:[],weChat:"",assistant_id:"0"},this.getUserList()},exportContact:function(){location.href="/index.php?r=uc/customer/export-friends&key="+this.queryParam.key+"&label="+this.queryParam.label},collocation:function(t){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/customer/room-switch",data:{roomId:t.id,status:"1"==t.trusteeship?"10":"0"}}).then(function(t){1==t.data.status&&e.getRoomList()})},collocationAll:function(){var t=this;if(this.collocationStatus="1",0==this.selectedRowKeys.length)return void this.$message.warning("请选择对应的群");this.welcomeList.forEach(function(e){t.$set(e,"check",!1)}),this.replyList.forEach(function(e){t.$set(e,"check",!1)}),this.getWelcomeList(),this.getReplyList(),this.collocation_visible=!0},collocationOne:function(t){var e=this;this.selectRoomId=t.id,this.collocationStatus="2",this.welcomeList.forEach(function(t){e.$set(t,"check",!1)}),this.replyList.forEach(function(t){e.$set(t,"check",!1)}),this.getWelcomeList(t),this.getReplyList(t),this.collocation_visible=!0},notice:function(t){var e=this;this.noticeObj.room_id=[],this.com_visible=!0,this.noticeObj.room_id.push(t.id),this.$nextTick(function(t){e.$refs.div_edit.clearContent(),e.$forceUpdate()})},noticeSendAll:function(){if(0==this.selectedRowKeys.length)return void this.$message.warning("请选择对应的群");this.com_visible=!0,this.noticeObj.room_id=this.selectedRowKeys},roomNotice:function(){var t=this;if(this.noticeObj.text.replace(/<br\/?>/g,"").match(/^\s*$/))return void this.$message.warning("不能发送空白公告");var e=[];this.roomList.forEach(function(n){t.noticeObj.room_id.forEach(function(t){n.id==t&&e.push(n)})}),e.forEach(function(e){p.isOfflineRobot(e.room_owner,t.$store.state.user.offlineRobot)&&t.$store.commit("user/setRobotStatus","2");var n={cmd:2021,fromClientId:t.$store.state.user.user.user_id,toClientId:e.room_owner,cmdData:{username:e.room_wx_id,noticeContent:m.htmlToString(t.noticeObj.text)}};t.$ws.sendMsgFun(n)}),this.$ws.cmd2021=function(e){4==e.status&&t.$notification.warning({message:function(t){return t("div",{domProps:{innerHTML:e.callbackMsg}})},description:"暂无法执行操作，请检查手机连接状态",duration:2,style:{background:"#fbf8e9"}})},this.com_visible=!1,this.noticeObj={text:"",room_id:[]},this.selectedRowKeys=[]},com_handleCancel:function(){this.com_visible=!1},onSelectChange:function(t){this.selectedRowKeys=t},onChange:function(t,e){this.page=t,this.page_size=e,this.selectedRowKeys=[],this.getRoomList()},onShowSizeChange:function(t,e){this.page=1,this.page_size=e,this.selectedRowKeys=[],this.getRoomList()},handleSubmit:function(){this.page=1,this.page_size=10,this.getRoomList()},getAllRoomLabel:function(){var t=this;this.$axios({method:"POST",url:"/index.php?r=uc/customer/room-label-all",data:{department_id:this.queryParam.department_id}}).then(function(e){var n=e.data;1==n.status&&(t.labelList=n.data)})},getRoomList:function(){var t=this;console.log(this.queryParam),this.$axios({method:"POST",url:"/index.php?r=uc/customer/room-list",data:s()(this.queryParam,{p:this.page,n:this.page_size})}).then(function(e){var n=e.data;1==n.status?(t.roomList=n.data.list,t.total=parseInt(n.data.count)):t.$message.warn(n.msg)})},getDetail:function(t){this.$router.push({path:"/home/groupDetails",query:{id:t.id,department_id:this.queryParam.department_id,user_id:t.user_id}})},sendMsg:function(t,e,n){f.store.set("menuNav","聚合聊天"),this.$router.push({path:"/liveChat",query:{id:t,user_id:e,type:"room",username:n}})},upInfo:function(){this.getRoomList()},imgExists:function(t){console.log("imgLoadError");var e=this.$store.state.user.user.default_url,n=new Image;n.onload=function(){(n.filesize>0||n.width>0&&n.height>0)&&(t.target.src=e,n=null)},n.src=e},showEmoji:function(){this.$store.commit("liveChat/setEmojiFlag",!this.emojiFlag)},closeEmoji:function(){this.$store.commit("liveChat/setEmojiFlag",!1)},emojiAdd:function(t){document.getElementById("notice_area").focus();var e="<img src='static/img_file/emojiBG.png' class= '"+t.currentTarget.classList.value+"' title_name='"+t.currentTarget.attributes.title_name.nodeValue+"'>";this.emojiAddInPosition(e),this.$refs.div_edit.changeTxt()},emojiAddInPosition:function(t,e){var n=void 0,i=void 0;if(e||this.getRange(),window.getSelection){!e&&this.range?(n=this.sel,i=this.range):(n=window.getSelection(),i=n.getRangeAt(0)),i.deleteContents(),n=window.getSelection();var a=void 0,o=void 0;if(i.createContextualFragment)a=i.createContextualFragment(t);else{var s=document.createElement("div");for(s.innerHTML=t,a=document.createDocumentFragment();o=s.firstChild;)a.appendChild(o)}var r=a.lastChild;i.insertNode(a),i.setStartAfter(r),n.removeAllRanges(),n.addRange(i);var c=document.getElementById("notice_area"),l=r.offsetTop-55+r.offsetHeight-c.offsetHeight;c.scrollTop<l&&(c.scrollTop=l)}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},getSel:function(){window.getSelection?(this.sel=window.getSelection(),this.range=this.sel.getRangeAt(0)):this.range=document.selection.createRange()},getRange:function(){this.range?window.getSelection?(this.sel.removeAllRanges(),this.sel.addRange(this.range)):this.range.select():this.setRange()},setRange:function(){var t,e,n=document.getElementById("notice_area");document.createRange?(t=document.createRange(),t.selectNodeContents(n),t.collapse(!1),e=window.getSelection(),e.removeAllRanges(),e.addRange(t)):document.selection&&(t=document.body.createTextRange(),t.moveToElementText(n),t.collapse(!1),t.select())},getWelcomeList:function(t){var e=this;this.$axios({method:"GET",url:"/index.php?r=uc/sale/welcome-list",params:{departmentId:this.queryParam.department_id,all:"1",type:"20"}}).then(function(n){var i=n.data;if(1==i.status){if(e.welcomeList=i.data.list,1==e.selectedRowKeys.length&&"1"==e.collocationStatus){var a="";e.roomList.forEach(function(t){t.id==e.selectedRowKeys[0]&&(a=t.welcome.list.length&&t.welcome.list[0].id)}),e.welcomeList.forEach(function(t){t.id==a&&e.$set(t,"check",!0)})}"2"==e.collocationStatus&&0!=t.welcome.list.length&&e.welcomeList.forEach(function(n){n.id==t.welcome.list[0].id&&e.$set(n,"check",!0)})}})},getReplyList:function(t){var e=this;this.$axios({method:"GET",url:"/index.php?r=uc/sale/reply-list",params:{departmentId:this.queryParam.department_id,all:"1"}}).then(function(n){var i=n.data;if(1==i.status){if(e.replyList=i.data.list,1==e.selectedRowKeys.length&&"1"==e.collocationStatus){var a="";e.roomList.forEach(function(t){t.id==e.selectedRowKeys[0]&&(a=t.auto_reply.length&&t.auto_reply.list[0].id)}),e.replyList.forEach(function(t){t.id==a&&e.$set(t,"check",!0)})}"2"==e.collocationStatus&&0!=t.auto_reply.list.length&&e.replyList.forEach(function(n){n.id==t.auto_reply.list[0].id&&e.$set(n,"check",!0)})}})},handleTagChange:function(t,e,n,i){var a=this;"1"==i?(this.welcomeList.forEach(function(t){a.$set(t,"check",!1)}),this.$set(this.welcomeList[e],"check",n)):"2"==i&&(this.replyList.forEach(function(t){a.$set(t,"check",!1)}),this.$set(this.replyList[e],"check",n)),this.$forceUpdate()},handleTagOk:function(){var t=this,e=[],n=[];this.welcomeList.forEach(function(t){t.check&&e.push(t.id)}),this.replyList.forEach(function(t){t.check&&n.push(t.id)}),this.$axios({method:"POST",url:"/index.php?r=uc/sale/bind-room",data:{roomIds:"1"==this.collocationStatus?this.selectedRowKeys:[this.selectRoomId],welcomeId:e[0],replyId:n[0],type:"1"}}).then(function(e){1==e.data.status&&(t.collocation_visible=!1,t.$message.success("设置成功"),t.selectedRowKeys=[],t.getRoomList())})},treeList:function(){this.departmentList=this.listToTree(JSON.parse(a()(this.$store.state.user.department))),console.log(this.$store.state.user.department),this.queryParam.department_id=this.$store.state.user.user.department.id||this.departmentList[0].key,this.getAllRoomLabel(),this.getUserList()},listToTree:function(t,e){var n=this,i=[];return t.forEach(function(t,e){t.children&&t.children.length>0&&(t.children=n.listToTree(t.children,e)),i.push({title:t.name,key:t.id,value:t.id,children:t.children})}),i},onSelect:function(t,e){this.$store.state.user.user.department.id===t?this.disableDepartment=!0:this.disableDepartment=!1,this.page=1,this.page_size=10,this.queryParam.label=[],this.queryParam.department_id=t,this.getUserList(t),this.getAllRoomLabel()},getWeChat:function(t){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/communication/user-assistant",data:{user_id:t}}).then(function(t){var n=t.data;1===n.status&&(e.weChatList=n.data,e.weChatList.length?e.queryParam.assistant_id=n.data[0].username:e.queryParam.assistant_id="0",e.weChatList.length?e.queryParam.weChat=0:e.queryParam.weChat="无匹配结果",e.getRoomList())})},getUserList:function(){var t=this;this.$axios({method:"post",url:"/index.php?r=uc/organization/user",data:{department_id:this.queryParam.department_id,type:1}}).then(function(e){var n=e.data;if(1==n.status){t.managerList=n.data.userList;var i="";t.managerList.forEach(function(e){e.id===t.$store.state.user.user.user_id&&(i=t.$store.state.user.user.user_id)}),i?t.queryParam.user_id=i:t.managerList[0]&&t.managerList[0].id?t.queryParam.user_id=t.managerList[0].id:t.managerList.unshift({id:"0",user_name:"无匹配结果"})&&(t.queryParam.user_id="0"),i?t.getWeChat(i):t.managerList[0]?t.getWeChat(t.managerList[0].id):t.getWeChat(0)}})}},created:function(){this.treeList()},beforeDestroy:function(){this.$ws.cmd2020=null,this.$ws.cmd2021=null,window.removeEventListener("resize")}}},1689:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},1690:function(t,e,n){e=t.exports=n(15)(!1),e.push([t.i,"\n.customer-list[data-v-184b865a] {\n  background: #ffffff;\n  position: relative;\n  padding: 0 14px;\n  border-radius: 3px;\n  height: calc(100vh - 90px);\n}\n.customer-list .header[data-v-184b865a] {\n  padding: 12px 0;\n  background: #fff;\n}\n.customer-list .content[data-v-184b865a] {\n  position: relative;\n}\n.fl[data-v-184b865a] {\n  float: left;\n}\n.fr[data-v-184b865a] {\n  float: right;\n}\n.clr[data-v-184b865a]:after {\n  display: block;\n  height: 0;\n  content: '';\n  visibility: hidden;\n  clear: both;\n}\n.input-content[data-v-184b865a] {\n  padding: 0 0 10px 0;\n  height: auto;\n  border-top: none;\n}\n.input-content .tools[data-v-184b865a] {\n  position: absolute;\n  bottom: -14px;\n  left: -10px;\n  display: flex;\n}\n.input-content .tools > div[data-v-184b865a] {\n  padding: 0 10px;\n  cursor: pointer;\n}\n.input-content .tools > div .anticon svg[data-v-184b865a] {\n  font-size: 20px;\n}\n.input-content .tools > div #emoji[data-v-184b865a] {\n  position: absolute;\n  top: -165px;\n  width: 390px;\n  height: 155px;\n  left: 0;\n  border: 1px solid #cccccc;\n  padding: 5px;\n  z-index: 10;\n  line-height: 1;\n  background: #ffffff;\n  box-shadow: 0px 1px 10px 3px #ccc;\n}\n.input-content .tools > div #emoji[data-v-184b865a]::after {\n  margin-top: -1px;\n  border: 7px solid transparent;\n  border-top-color: #fff;\n  content: \"\";\n  position: absolute;\n  left: 16px;\n  top: 100%;\n  margin-left: -5px;\n}\n.input-content .input-content-area[data-v-184b865a] {\n  word-wrap: break-word;\n  white-space: normal;\n}\n.input-content .input-content-area #notice_area[data-v-184b865a] {\n  border: 1px solid #ccc;\n}\n.input-content .input-content-area #emoji[data-v-184b865a] {\n  position: absolute;\n  top: -160px;\n  width: 390px;\n  height: 155px;\n  left: 0;\n  border: 1px solid #cccccc;\n  padding: 5px;\n  z-index: 10;\n  line-height: 1;\n  background: #ffffff;\n}\n.tag-modal .ant-tag[data-v-184b865a]:hover {\n  background: #5AA9CD;\n  color: #ffffff;\n}\n.tag-modal .ant-tag-checkable[data-v-184b865a] {\n  border: 1px solid #d9d9d9;\n  background: #fafafa;\n}\n.tag-modal .ant-tag-checkable-checked[data-v-184b865a] {\n  background: #5AA9CD;\n}\n.ant-tag[data-v-184b865a]:hover {\n  background: #5AA9CD;\n  color: #ffffff;\n  opacity: 1;\n}\n.stausPage[data-v-184b865a] {\n  position: absolute;\n  left: 50%;\n  top: 200px;\n  z-index: 999;\n  transform: translate(-50%, 0);\n}\n",""])},2090:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"customer-list"},[i("div",{ref:"header",staticClass:"header"},[i("a-form",{attrs:{layout:"inline",form:t.form},on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[i("a-row",{staticClass:"clr"},[i("a-col",{attrs:{span:24}},[i("div",{staticClass:"fl"},[i("a-form-item",{attrs:{label:"选择部门"}},[i("a-tree-select",{staticStyle:{"min-width":"200px"},attrs:{treeData:t.departmentList,treeDefaultExpandAll:!0},on:{select:t.onSelect},model:{value:t.queryParam.department_id,callback:function(e){t.$set(t.queryParam,"department_id",e)},expression:"queryParam.department_id"}})],1)],1),t._v(" "),i("div",{staticClass:"fl"},[i("a-form-item",{attrs:{label:"客户经理"}},[i("a-select",{staticStyle:{width:"150px"},attrs:{placeholder:"选择客户经理",disabled:t.disableDepartment&&!t.$store.state.user.user.see_department_power},on:{change:t.managerChange},model:{value:t.queryParam.user_id,callback:function(e){t.$set(t.queryParam,"user_id",e)},expression:"queryParam.user_id "}},t._l(t.managerList,function(e,n){return i("a-select-option",{key:e.id},[t._v("\n                                    "+t._s(e.user_name)+"\n                                ")])}),1)],1)],1),t._v(" "),i("div",{staticClass:"fl"},[i("a-form-item",{attrs:{label:"微信"}},[i("a-select",{staticStyle:{width:"150px"},attrs:{placeholder:"选择微信号"},on:{change:t.choseWeChat},model:{value:t.queryParam.weChat,callback:function(e){t.$set(t.queryParam,"weChat",e)},expression:"queryParam.weChat"}},t._l(t.weChatList,function(e,n){return i("a-select-option",{key:n},[t._v("\n                                    "+t._s(e.nickname?e.nickname:"未命名")+"\n                                ")])}),1)],1)],1),t._v(" "),i("div",{staticClass:"fl"},[i("a-form-item",{attrs:{label:"搜索群名"}},[i("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入群名关键字"},model:{value:t.queryParam.key,callback:function(e){t.$set(t.queryParam,"key",e)},expression:"queryParam.key"}})],1)],1),t._v(" "),i("div",{staticClass:"fl"},[i("a-form-item",{attrs:{label:"选择标签"}},[i("a-select",{staticStyle:{"min-width":"200px"},attrs:{mode:"multiple",placeholder:"全部"},model:{value:t.queryParam.label,callback:function(e){t.$set(t.queryParam,"label",e)},expression:"queryParam.label"}},t._l(t.labelList,function(e,n){return i("a-select-option",{key:e.id},[t._v(t._s(e.title))])}),1)],1)],1),t._v(" "),i("div",{staticClass:"fl"},[i("a-form-item",[i("a-button",{attrs:{type:"primary",htmlType:"submit"}},[t._v("搜索")]),t._v(" "),i("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.clear}},[t._v("重置")])],1)],1)])],1)],1)],1),t._v(" "),i("div",{staticClass:"content"},[i("a-table",{ref:"table",class:[t.heightFlg?"scrollheade":"scrollheader"],attrs:{filterMultiple:"true",type:"checkbox",scroll:{y:t.sheight},rowClassName:function(t,e){return e%2==0?"bg-row":"bg-row-gray"},columns:t.columns,locale:t.locale,dataSource:t.roomList,pagination:!1,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"avatar_url",fn:function(e,a,o){return[i("div",[i("img",{staticStyle:{width:"38px",height:"38px","border-radius":"5px"},attrs:{src:n(1278)},on:{error:function(e){return t.imgExists(e)}}})])]}},{key:"room_name",fn:function(e,a,o){return[i("div",[i("span",[t._v(t._s(""==e?"未命名的群":e))]),t._v(" "),-1!=a.room_wx_id.search(/@im.chatroom/)?i("img",{staticStyle:{height:"17px","border-radius":"5px"},attrs:{src:n(1287)}}):t._e()])]}},{key:"qr_code",fn:function(e,n,a){return[i("div",[t.qrExpireTime(n.qr_code_expire_time)?i("a-tooltip",{attrs:{placement:"left"}},[i("template",{slot:"title"},[i("img",{staticStyle:{width:"300px",height:"300px","border-radius":"5px"},attrs:{src:e}})]),t._v(" "),i("img",{staticStyle:{width:"60px",height:"60px","border-radius":"5px"},attrs:{src:e}})],2):i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.getExpireQR(n)}}},[t._v("获取群二维码")])],1)]}},{key:"trusteeship",fn:function(e,n,a){return[i("div",{staticStyle:{position:"relative"}},[i("div",{staticStyle:{display:"inline-block"}},t._l(n.welcome.list,function(e,n){return i("a-tag",{key:n,staticStyle:{"margin-bottom":"10px",background:"#5AA9CD",color:"#ffffff"}},[t._v("\n                            "+t._s(e.name)+"\n                        ")])}),1),t._v(" "),i("div",{staticStyle:{display:"inline-block"}},t._l(n.auto_reply.list,function(e,n){return i("a-tag",{key:n,staticStyle:{background:"#5AA9CD",color:"#ffffff"}},[t._v("\n                            "+t._s(e.class_name)+"\n                        ")])}),1),t._v(" "),i("a-icon",{staticStyle:{position:"absolute",right:"0",top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"#fff",background:"#5AA9CD",padding:"1px"},attrs:{type:"setting",theme:"filled"},on:{click:function(e){return t.collocationOne(n)}}})],1)]}},{key:"action",fn:function(e,n,a){return[i("div",[t.queryParam.department_id==t.$store.state.user.user.department.id?i("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.sendMsg(n.id,n.user_id,n.room_owner)}}},[t._v("发消息")]):t._e(),t._v(" "),i("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.getDetail(n)}}},[t._v("详细信息")]),t._v(" "),i("a",{staticStyle:{"padding-right":"15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.notice(n)}}},[t._v("公告")]),t._v(" "),i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.collocation(n)}}},["1"==n.trusteeship?i("span",{staticStyle:{color:"rgb(223, 166, 156)"}},[t._v("关闭托管")]):i("span",[t._v("开启托管")])])])]}}])}),t._v(" "),i("div",{ref:"bottomPage"},[t.roomList.length?i("div",{class:[t.heightFlg?"bottomPageK":"bottomPage"]},[i("span",{staticStyle:{"vertical-align":"middle"}},[t.selectedRowKeys.length?i("a-button",{staticStyle:{float:"left","margin-left":"15px","margin-right":"10px"},attrs:{type:"primary",disabled:!(t.selectedRowKeys.length>1)},on:{click:t.collocationAll}},[t._v("托管")]):t._e(),t._v(" "),t.selectedRowKeys.length?i("a-button",{staticStyle:{float:"left"},attrs:{type:"primary",disabled:!(t.selectedRowKeys.length>1)},on:{click:t.noticeSendAll}},[t._v("公告")]):t._e()],1),t._v(" "),i("a-pagination",{staticStyle:{"text-align":"right",float:"right"},attrs:{showQuickJumper:"",showSizeChanger:"",showTotal:function(t){return"总共"+t+"条"},pageSize:t.page_size,total:t.total,pageSizeOptions:["10","20","30","40","50"]},on:{change:t.onChange,showSizeChange:t.onShowSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e()])],1),t._v(" "),i("a-modal",{attrs:{title:"公告",footer:null,visible:t.com_visible,width:"50%"},on:{cancel:t.com_handleCancel}},[i("div",{staticClass:"input-content",staticStyle:{position:"relative"}},[i("div",{staticClass:"tools"},[i("div",[i("a-icon",{attrs:{type:"smile",id:"showEmoji"},on:{click:function(e){return t.showEmoji()}}}),t._v(" "),t.emojiFlag?i("div",{attrs:{id:"emoji"}},t._l(t.emojiList,function(e,n){return i("a",{staticClass:"qqemoji",class:e.className,staticStyle:{cursor:"pointer"},attrs:{href:"javascript:;",title_name:e.title},on:{click:function(e){return t.emojiAdd(e)}}})}),0):t._e()],1)]),t._v(" "),i("div",{staticClass:"input-content-area"},[i("div-edit-area",{ref:"div_edit",attrs:{id:"notice_area",formItem:t.noticeObj},on:{change:function(e){return t.getSel()}}})],1)]),t._v(" "),i("div",{staticStyle:{"padding-top":"25px","text-align":"right"}},[i("a-button",{on:{click:t.com_handleCancel}},[t._v("取消")]),t._v(" "),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.roomNotice()}}},[t._v("确定")])],1)]),t._v(" "),i("a-modal",{attrs:{title:"托管",visible:t.collocation_visible,width:"50%"},on:{cancel:function(e){t.collocation_visible=!1},ok:t.handleTagOk}},[i("div",[i("span",[t._v("欢迎语：")]),t._v(" "),i("div",{staticClass:"tag-modal"},t._l(t.welcomeList,function(e,n){return i("a-checkable-tag",{key:n,attrs:{checked:e.check},on:{change:function(i){return t.handleTagChange(e,n,i,"1")}}},[t._v("\n                    "+t._s(e.name)+"\n                ")])}),1)]),t._v(" "),i("div",{staticStyle:{"margin-top":"50px"}},[i("span",[t._v("关键词回复：")]),t._v(" "),i("div",{staticClass:"tag-modal"},t._l(t.replyList,function(e,n){return i("a-checkable-tag",{key:n,attrs:{checked:e.check},on:{change:function(i){return t.handleTagChange(e,n,i,"2")}}},[t._v("\n                    "+t._s(e.class_name)+"\n                ")])}),1)])])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},2170:function(t,e,n){var i=n(1689);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(16)("6d58460b",i,!1)},2171:function(t,e,n){var i=n(1690);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(16)("4847be79",i,!1)}});