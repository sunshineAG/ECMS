webpackJsonp([48],{1221:function(e,t,i){i(2178),i(2177);var n=i(20)(i(1625),i(2094),"data-v-1cccea4b",null);n.options.__file="D:\\baozWork\\liejing\\js\\ECMS\\src\\view\\groupManage\\assignPermission.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] assignPermission.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},1625:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(137),s=i.n(n);i(32);t.default={name:"",data:function(){return{role_id:this.$route.query.id,title:"分配权限",permissionList:[],power:{},selectsKey:[],idArray:[],keyName:"",checkedAll:!1,allIndeterminate:!1}},mounted:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},updated:function(){this.$store.dispatch("setting/getBreadcrumb",this.$route)},methods:{telChange:function(e){1===e.auth?this.$set(e,"auth",0):this.$set(e,"auth",1)},changePower:function(e){"1"===e?"1"===this.power.see_superior_power?this.power.see_superior_power="0":this.power.see_superior_power="1":"2"===e?"1"===this.power.see_lower_power?this.power.see_lower_power="0":this.power.see_lower_power="1":"1"===this.power.see_department_power?this.power.see_department_power="0":this.power.see_department_power="1"},getSelectsKey:function(e){1===e.auth?(this.$set(e,"auth",0),e.list.forEach(function(e){e.auth=0,e.list&&e.list.forEach(function(e){e.auth=0})})):(this.$set(e,"auth",1),e.list.forEach(function(e){e.auth=1,e.list&&e.list.forEach(function(e){e.auth=1})}))},changeSelect:function(e,t){1===e.auth?(this.$set(e,"auth",0),e.list.forEach(function(e){e.auth=0})):(this.$set(e,"auth",1),this.$set(t,"auth",1),e.list.forEach(function(e){e.auth=1}))},selectCheck:function(e,t,i){1===e.auth?this.$set(e,"auth",0):(this.$set(e,"auth",1),this.$set(i,"auth",1),this.$set(t,"auth",1))},saveSelects:function(){var e=this;if(this.idArray=[],!this.keyName)return this.$message.warn("角色名称不能为空");for(var t in this.permissionList)if(1===this.permissionList[t].auth){this.idArray.push(this.permissionList[t].id);for(var i in this.permissionList[t].list)if(1===this.permissionList[t].list[i].auth){this.idArray.push(this.permissionList[t].list[i].id);for(var n in this.permissionList[t].list[i].list)1===this.permissionList[t].list[i].list[n].auth&&this.idArray.push(this.permissionList[t].list[i].list[n].id)}}this.$axios({method:"POST",url:"/index.php?r=uc/organization/permission-change",data:{role:s()(this.power,{role_name:this.keyName}),id_arr:this.idArray,role_id:this.role_id}}).then(function(t){1===t.data.status&&(e.$message.success("分配成功"),e.back())})},back:function(){this.$router.push({path:"/groupManage/permissionManage"})},handleSubmit:function(){var e=this,t=[];this.permissionList.forEach(function(e){e.checkedList.forEach(function(e){t.push(e)})}),this.$axios({method:"POST",url:"/index.php?r=uc/organization/permission-change",data:{role_id:this.role_id,name_arr:t}}).then(function(t){1==t.data.status&&(e.$message.success("分配成功"),e.back())})},getPermission:function(){var e=this;this.$axios({method:"POST",url:"/index.php?r=uc/organization/permission-list",data:{role_id:this.role_id}}).then(function(t){var i=t.data;1==i.status&&(e.permissionList=i.data.permissionList,e.power=i.data.power,e.keyName=i.data.power.role_name)})},dataTrans:function(e){return e.forEach(function(e){var t=0;e.checkedList=[],e.list.forEach(function(i){1==i.auth&&(t+=1,e.checkedList.push(i.name)),i.label=i.description,i.value=i.name}),t==e.list.length?e.checked=!0:e.checked=!1,t&&t<e.list.length?e.indeterminate=!0:e.indeterminate=!1}),e},onChange:function(e,t){e.indeterminate=!!e.checkedList.length&&e.checkedList.length<e.list.length,e.checked=e.checkedList.length===e.list.length,this.getAllChecked(!1)},onCheckAllChange:function(e,t,i){t.checked=!t.checked,t.indeterminate=!1,t.checkedList=[],t.checked?t.list.forEach(function(e){t.checkedList.push(e.name)}):t.checkedList=[],this.getAllChecked(!1)},onChangeAll:function(e){this.checkedAll=e.target.checked,this.allIndeterminate=!1,e.target.checked?this.permissionList.forEach(function(e){e.checkedList=[],e.list.forEach(function(t){e.checkedList.push(t.name)}),e.checked=!0}):this.permissionList.forEach(function(e){e.indeterminate=!1,e.checked=!1,e.checkedList=[]})},getAllChecked:function(e){if(e){var t=!1,i=!1;this.permissionList.forEach(function(e){e.list.forEach(function(e){0==e.auth&&(t=!0),1==e.auth&&(i=!0)})}),t&&i?(this.checkedAll=!1,this.allIndeterminate=!0):t&&!i?(this.checkedAll=!1,this.allIndeterminate=!1):(!t&&i||!i&&t)&&(this.checkedAll=!0,this.allIndeterminate=!1)}else{var n=0,s=0,a=0;this.permissionList.forEach(function(e){e.checkedList.length===e.list.length?n+=1:0==e.checkedList.length?s+=1:a+=1}),n==this.permissionList.length?(this.checkedAll=!0,this.allIndeterminate=!1):s==this.permissionList.length?(this.checkedAll=!1,this.allIndeterminate=!1):(this.checkedAll=!0,this.allIndeterminate=!0)}}},created:function(){this.getPermission()},destroyed:function(){}}},1696:function(e,t,i){t=e.exports=i(15)(!1),t.push([e.i,"\n.user-manage .content .ant-checkbox-group-item {\n    margin-bottom: 5px;\n    width: 150px;\n}\n",""])},1697:function(e,t,i){t=e.exports=i(15)(!1),t.push([e.i,"\n.user-manage[data-v-1cccea4b] {\n  height: calc(100vh - 90px);\n  overflow-y: auto;\n}\n.user-manage .header[data-v-1cccea4b] {\n  padding: 0 20px;\n  height: 60px;\n  line-height: 60px;\n  border-bottom: 2px solid #f0f2f5;\n  background: #ffffff;\n}\n.user-manage .header .add-user[data-v-1cccea4b] {\n  float: right;\n}\n.user-manage .content[data-v-1cccea4b] {\n  background: #ffffff;\n}\n.user-manage .content .nav[data-v-1cccea4b] {\n  height: 54px;\n  line-height: 54px;\n  background: #DDDDDD;\n  text-align: center;\n  color: #242424;\n  font-weight: bold;\n}\n.user-manage .contentTitle[data-v-1cccea4b] {\n  background: #ffffff;\n  margin: 10px 0;\n}\n.user-manage .contentTitle .titleNave[data-v-1cccea4b] {\n  background: #DDDDDD;\n  height: 54px;\n  line-height: 54px;\n  color: #242424;\n  font-weight: bold;\n}\n.user-manage .contentTitle .row[data-v-1cccea4b] {\n  height: 54px;\n  line-height: 54px;\n  border-bottom: 1px solid #f0f0f0;\n}\n.user-manage .backgroundColr[data-v-1cccea4b] {\n  background: #F5F5F5;\n}\n",""])},2094:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"user-manage"},[i("div",{staticClass:"header clearFloat"},[i("div",{staticStyle:{float:"left"}},[i("span",{staticStyle:{color:"#242424","font-weight":"bold"}},[e._v("角色名称：")]),e._v(" "),i("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入角色名称"},model:{value:e.keyName,callback:function(t){e.keyName=t},expression:"keyName"}})],1),e._v(" "),i("div",{staticClass:"add-user"},[i("a-button",{on:{click:e.back}},[e._v("取消")]),e._v(" "),i("a-button",{attrs:{type:"primary"},on:{click:e.saveSelects}},[e._v("保存")])],1)]),e._v(" "),i("div",{staticClass:"contentTitle"},[i("a-row",{staticClass:"titleNave"},[i("a-col",{attrs:{span:"3",align:"center"}},[e._v("\n                其它\n            ")]),e._v(" "),i("a-col",{attrs:{span:"21"}},[i("a-row",[i("a-col",{attrs:{span:"4",align:"center"}},[e._v("选择权限")])],1)],1)],1),e._v(" "),i("a-row",{staticClass:"row"},[i("a-col",{attrs:{span:"4"}},[i("span",{staticStyle:{"margin-left":"30px"}},[e._v("\n                数据查看范围\n                ")])]),e._v(" "),i("a-col",{attrs:{span:"20"}},[i("a-checkbox",{attrs:{checked:"1"===e.power.see_superior_power},on:{change:function(t){return e.changePower("1")}}},[e._v("父部门数据")]),e._v(" "),i("a-checkbox",{attrs:{checked:"1"===e.power.see_lower_power},on:{change:function(t){return e.changePower("2")}}},[e._v("子部门数据")]),e._v(" "),i("a-checkbox",{attrs:{checked:"1"===e.power.see_department_power},on:{change:function(t){return e.changePower("3")}}},[e._v("所在部门数据")]),e._v(" "),i("a-checkbox",{attrs:{checked:!0,disabled:!0}},[e._v("个人数据")])],1)],1)],1),e._v(" "),i("div",{staticClass:"content"},[i("div",[i("div",[i("a-row",{staticClass:"nav"},[i("a-col",{attrs:{span:"3"}},[e._v("\n                    一级菜单\n                ")]),e._v(" "),i("a-col",{attrs:{span:"21"}},[i("a-row",[i("a-col",{attrs:{span:"4"}},[e._v("二级菜单")]),e._v(" "),i("a-col",{attrs:{span:"20"}},[e._v("功能模块")])],1)],1)],1)],1),e._v(" "),e._l(e.permissionList,function(t,n){return i("div",{key:n,staticClass:"clearFloat",staticStyle:{"border-bottom":"1px solid #f0f0f0"}},[i("div",[i("a-row",[i("a-col",{attrs:{span:"3"}},[i("div",{staticStyle:{width:"100px",margin:"10px 0 10px 30px"}},[i("a-checkbox",{attrs:{checked:1===t.auth},on:{change:function(i){return e.getSelectsKey(t)}}},[e._v(e._s(t.name))])],1)]),e._v(" "),i("a-col",{attrs:{span:"21"}},e._l(t.list,function(n,s){return i("a-row",{key:s,staticStyle:{"border-left":"1px solid #f0f0f0","border-right":"1px solid #f0f0f0"}},[i("a-col",{staticStyle:{"padding-left":"10px"},attrs:{span:"4"}},[i("div",{staticStyle:{margin:"10px 0 10px 20px"}},[i("a-checkbox",{attrs:{checked:1===n.auth},on:{change:function(i){return e.changeSelect(n,t)}}},[e._v(e._s(n.name))])],1)]),e._v(" "),i("a-col",{staticStyle:{"border-left":"1px solid #f0f0f0","padding-left":"10px"},attrs:{span:"20"}},e._l(n.list,function(s,a){return i("div",{key:a,staticStyle:{"margin-right":"20px",display:"inline-block",padding:"10px 0"}},[i("div",[i("a-checkbox",{attrs:{value:s.id,checked:1===s.auth},on:{change:function(i){return e.selectCheck(s,t,n)}}},[e._v(e._s(s.name))])],1)])}),0)],1)}),1)],1)],1)])})],2)])])},staticRenderFns:[]},e.exports.render._withStripped=!0},2177:function(e,t,i){var n=i(1696);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(16)("10395b91",n,!1)},2178:function(e,t,i){var n=i(1697);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(16)("202c62e3",n,!1)}});